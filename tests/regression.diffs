*** /home/ildus/dev/clickhouse_fdw/tests/expected/http.out	2019-07-25 17:27:23.039789695 +0200
--- /home/ildus/dev/clickhouse_fdw/tests/results/http.out	2019-07-25 18:31:08.913049609 +0200
***************
*** 4,9 ****
--- 4,10 ----
  CREATE SERVER loopback FOREIGN DATA WRAPPER clickhouse_fdw OPTIONS(dbname 'regression', driver 'http');
  CREATE SERVER loopback2 FOREIGN DATA WRAPPER clickhouse_fdw OPTIONS(dbname 'regression');
  CREATE ROLE user1 SUPERUSER;
+ ERROR:  role "user1" already exists
  SET ROLE user1;
  CREATE USER MAPPING FOR public SERVER testserver1 OPTIONS (user 'value', password 'value');
  CREATE USER MAPPING FOR user1 SERVER loopback;
***************
*** 137,143 ****
  EXPLAIN (VERBOSE) SELECT * FROM ftcopy ORDER BY c1;
                                      QUERY PLAN                                     
  -----------------------------------------------------------------------------------
!  Foreign Scan on public.ftcopy  (cost=1.00..-1.00 rows=1 width=64)
     Output: c1, c2, c3, c4, c5, c6
     Remote SQL: SELECT c1, c2, c3, c4, c5, c6 FROM regression.tcopy ORDER BY c1 ASC
  (3 rows)
--- 138,144 ----
  EXPLAIN (VERBOSE) SELECT * FROM ftcopy ORDER BY c1;
                                      QUERY PLAN                                     
  -----------------------------------------------------------------------------------
!  Foreign Scan on public.ftcopy  (cost=1.00..-1.00 rows=2 width=64)
     Output: c1, c2, c3, c4, c5, c6
     Remote SQL: SELECT c1, c2, c3, c4, c5, c6 FROM regression.tcopy ORDER BY c1 ASC
  (3 rows)
***************
*** 358,366 ****
  EXPLAIN SELECT DISTINCT t1.c1, t2.c1 FROM ft2 t1 LEFT JOIN ft1 t2 ON (t1.c1 = t2.c1) order by t1.c1 LIMIT 10;
                           QUERY PLAN                          
  -------------------------------------------------------------
!  Limit  (cost=1.00..-1.00 rows=1 width=8)
     ->  Unique  (cost=1.00..-0.99 rows=1 width=8)
!          ->  Foreign Scan  (cost=1.00..-1.00 rows=1 width=1)
                 Relations: (ft2 t1) LEFT JOIN (ft1 t2)
  (4 rows)
  
--- 359,367 ----
  EXPLAIN SELECT DISTINCT t1.c1, t2.c1 FROM ft2 t1 LEFT JOIN ft1 t2 ON (t1.c1 = t2.c1) order by t1.c1 LIMIT 10;
                           QUERY PLAN                          
  -------------------------------------------------------------
!  Limit  (cost=1.00..-0.99 rows=1 width=8)
     ->  Unique  (cost=1.00..-0.99 rows=1 width=8)
!          ->  Foreign Scan  (cost=1.00..-1.00 rows=2 width=2)
                 Relations: (ft2 t1) LEFT JOIN (ft1 t2)
  (4 rows)
  

======================================================================

*** /home/ildus/dev/clickhouse_fdw/tests/expected/binary.out	2019-07-25 17:26:45.936457064 +0200
--- /home/ildus/dev/clickhouse_fdw/tests/results/binary.out	2019-07-25 18:31:09.099716272 +0200
***************
*** 116,155 ****
  	       id % 10,
  	       'foo'
  	FROM generate_series(1, 110) id;
  INSERT INTO ft2
  	SELECT id,
  	       'AAA' || to_char(id, 'FM000')
  	FROM generate_series(1, 100) id;
  INSERT INTO ft3
  	SELECT id,
  	       id + 1,
  	       'AAA' || to_char(id, 'FM000')
  	FROM generate_series(1, 100) id;
  INSERT INTO ft4
  	SELECT id,
  	       id + 1,
  	       'AAA' || to_char(id, 'FM000')
  	FROM generate_series(1, 100) id;
  COPY ftcopy FROM stdin;
  INSERT INTO ftcopy VALUES
  	(3, 4, '1990-03-03', '1990-03-03 12:02:02', '12:02:02', 'val3'),
  	(4, 5, '1991-04-04', '1990-04-04 12:04:04', '12:02:04', 'val4');
  EXPLAIN (VERBOSE) SELECT * FROM ftcopy ORDER BY c1;
                                      QUERY PLAN                                     
  -----------------------------------------------------------------------------------
!  Foreign Scan on public.ftcopy  (cost=1.00..-1.00 rows=1 width=64)
     Output: c1, c2, c3, c4, c5, c6
     Remote SQL: SELECT c1, c2, c3, c4, c5, c6 FROM regression.tcopy ORDER BY c1 ASC
  (3 rows)
  
  SELECT * FROM ftcopy ORDER BY c1;
!  c1 | c2 |     c3     |         c4          |    c5    |  c6  
! ----+----+------------+---------------------+----------+------
!   1 |  2 | 1990-01-01 | 1990-01-01 10:01:02 | 10:01:02 | val1
!   2 |  3 | 1990-02-02 | 1990-02-02 11:02:03 | 11:01:02 | val2
!   3 |  4 | 1990-03-03 | 1990-03-03 12:02:02 | 12:02:02 | val3
!   4 |  5 | 1991-04-04 | 1990-04-04 12:04:04 | 12:02:04 | val4
! (4 rows)
  
  ALTER USER MAPPING FOR public SERVER testserver1
  	OPTIONS (DROP user, DROP password);
--- 116,157 ----
  	       id % 10,
  	       'foo'
  	FROM generate_series(1, 110) id;
+ ERROR:  clickhouse_fdw: insertion is not implemented for binary protocol yet
  INSERT INTO ft2
  	SELECT id,
  	       'AAA' || to_char(id, 'FM000')
  	FROM generate_series(1, 100) id;
+ ERROR:  clickhouse_fdw: insertion is not implemented for binary protocol yet
  INSERT INTO ft3
  	SELECT id,
  	       id + 1,
  	       'AAA' || to_char(id, 'FM000')
  	FROM generate_series(1, 100) id;
+ ERROR:  clickhouse_fdw: insertion is not implemented for binary protocol yet
  INSERT INTO ft4
  	SELECT id,
  	       id + 1,
  	       'AAA' || to_char(id, 'FM000')
  	FROM generate_series(1, 100) id;
+ ERROR:  clickhouse_fdw: insertion is not implemented for binary protocol yet
  COPY ftcopy FROM stdin;
+ ERROR:  clickhouse_fdw: insertion is not implemented for binary protocol yet
  INSERT INTO ftcopy VALUES
  	(3, 4, '1990-03-03', '1990-03-03 12:02:02', '12:02:02', 'val3'),
  	(4, 5, '1991-04-04', '1990-04-04 12:04:04', '12:02:04', 'val4');
+ ERROR:  clickhouse_fdw: insertion is not implemented for binary protocol yet
  EXPLAIN (VERBOSE) SELECT * FROM ftcopy ORDER BY c1;
                                      QUERY PLAN                                     
  -----------------------------------------------------------------------------------
!  Foreign Scan on public.ftcopy  (cost=1.00..-1.00 rows=2 width=64)
     Output: c1, c2, c3, c4, c5, c6
     Remote SQL: SELECT c1, c2, c3, c4, c5, c6 FROM regression.tcopy ORDER BY c1 ASC
  (3 rows)
  
  SELECT * FROM ftcopy ORDER BY c1;
!  c1 | c2 | c3 | c4 | c5 | c6 
! ----+----+----+----+----+----
! (0 rows)
  
  ALTER USER MAPPING FOR public SERVER testserver1
  	OPTIONS (DROP user, DROP password);
***************
*** 168,193 ****
  
  \set VERBOSITY terse
  SELECT c3, c4 FROM ft1 ORDER BY c3, c1 LIMIT 1;  -- should work
!   c3   |     c4     
! -------+------------
!  00001 | 1990-01-01
! (1 row)
  
  ALTER SERVER loopback OPTIONS (SET dbname 'no such database');
  SELECT c3, c4 FROM ft1 ORDER BY c3, c1 LIMIT 1;  -- should fail
! ERROR:  CH:Code: 81, e.displayText() = DB::Exception: Database `no such database` doesn't exist
! QUERY:SELECT c1, c3, c4 FROM "no such database".t1 ORDER BY c3 ASC, c1 ASC
  ALTER USER MAPPING FOR user1 SERVER loopback OPTIONS (ADD user 'no such user');
  SELECT c3, c4 FROM ft1 ORDER BY c3, c1 LIMIT 1;  -- should fail
! ERROR:  CH:Code: 192, e.displayText() = DB::Exception: Unknown user no such user
! QUERY:SELECT c1, c3, c4 FROM "no such database".t1 ORDER BY c3 ASC, c1 ASC
  ALTER SERVER loopback OPTIONS (SET dbname 'regression');
  ALTER USER MAPPING FOR user1 SERVER loopback OPTIONS (DROP user);
  SELECT c3, c4 FROM ft1 ORDER BY c3, c1 LIMIT 1;  -- should work again
!   c3   |     c4     
! -------+------------
!  00001 | 1990-01-01
! (1 row)
  
  \set VERBOSITY default
  ANALYZE ft1;
--- 170,191 ----
  
  \set VERBOSITY terse
  SELECT c3, c4 FROM ft1 ORDER BY c3, c1 LIMIT 1;  -- should work
!  c3 | c4 
! ----+----
! (0 rows)
  
  ALTER SERVER loopback OPTIONS (SET dbname 'no such database');
  SELECT c3, c4 FROM ft1 ORDER BY c3, c1 LIMIT 1;  -- should fail
! ERROR:  clickhouse_fdw: connection error: DB::Exception: Database no such database doesn't exist
  ALTER USER MAPPING FOR user1 SERVER loopback OPTIONS (ADD user 'no such user');
  SELECT c3, c4 FROM ft1 ORDER BY c3, c1 LIMIT 1;  -- should fail
! ERROR:  clickhouse_fdw: connection error: DB::Exception: Unknown user no such user
  ALTER SERVER loopback OPTIONS (SET dbname 'regression');
  ALTER USER MAPPING FOR user1 SERVER loopback OPTIONS (DROP user);
  SELECT c3, c4 FROM ft1 ORDER BY c3, c1 LIMIT 1;  -- should work again
!  c3 | c4 
! ----+----
! (0 rows)
  
  \set VERBOSITY default
  ANALYZE ft1;
***************
*** 199,217 ****
  (2 rows)
  
  SELECT * FROM ft1 ORDER BY c3, c1 OFFSET 100 LIMIT 10;
!  c1  | c2 |  c3   |     c4     |     c5     | c6 |     c7     | c8  
! -----+----+-------+------------+------------+----+------------+-----
!  101 |  1 | 00101 | 1990-01-01 | 1990-01-01 | 1  | 1          | foo
!  102 |  2 | 00102 | 1990-01-01 | 1990-01-01 | 2  | 2          | foo
!  103 |  3 | 00103 | 1990-01-01 | 1990-01-01 | 3  | 3          | foo
!  104 |  4 | 00104 | 1990-01-01 | 1990-01-01 | 4  | 4          | foo
!  105 |  5 | 00105 | 1990-01-01 | 1990-01-01 | 5  | 5          | foo
!  106 |  6 | 00106 | 1990-01-01 | 1990-01-01 | 6  | 6          | foo
!  107 |  7 | 00107 | 1990-01-01 | 1990-01-01 | 7  | 7          | foo
!  108 |  8 | 00108 | 1990-01-01 | 1990-01-01 | 8  | 8          | foo
!  109 |  9 | 00109 | 1990-01-01 | 1990-01-01 | 9  | 9          | foo
!  110 |  0 | 00110 | 1990-01-01 | 1990-01-01 | 0  | 0          | foo
! (10 rows)
  
  EXPLAIN (VERBOSE, COSTS OFF) SELECT * FROM ft1 t1 ORDER BY t1.c3, t1.c1, t1.tableoid OFFSET 100 LIMIT 10;
                                       QUERY PLAN                                     
--- 197,205 ----
  (2 rows)
  
  SELECT * FROM ft1 ORDER BY c3, c1 OFFSET 100 LIMIT 10;
!  c1 | c2 | c3 | c4 | c5 | c6 | c7 | c8 
! ----+----+----+----+----+----+----+----
! (0 rows)
  
  EXPLAIN (VERBOSE, COSTS OFF) SELECT * FROM ft1 t1 ORDER BY t1.c3, t1.c1, t1.tableoid OFFSET 100 LIMIT 10;
                                       QUERY PLAN                                     
***************
*** 227,245 ****
  (8 rows)
  
  SELECT * FROM ft1 t1 ORDER BY t1.c3, t1.c1, t1.tableoid OFFSET 100 LIMIT 10;
!  c1  | c2 |  c3   |     c4     |     c5     | c6 |     c7     | c8  
! -----+----+-------+------------+------------+----+------------+-----
!  101 |  1 | 00101 | 1990-01-01 | 1990-01-01 | 1  | 1          | foo
!  102 |  2 | 00102 | 1990-01-01 | 1990-01-01 | 2  | 2          | foo
!  103 |  3 | 00103 | 1990-01-01 | 1990-01-01 | 3  | 3          | foo
!  104 |  4 | 00104 | 1990-01-01 | 1990-01-01 | 4  | 4          | foo
!  105 |  5 | 00105 | 1990-01-01 | 1990-01-01 | 5  | 5          | foo
!  106 |  6 | 00106 | 1990-01-01 | 1990-01-01 | 6  | 6          | foo
!  107 |  7 | 00107 | 1990-01-01 | 1990-01-01 | 7  | 7          | foo
!  108 |  8 | 00108 | 1990-01-01 | 1990-01-01 | 8  | 8          | foo
!  109 |  9 | 00109 | 1990-01-01 | 1990-01-01 | 9  | 9          | foo
!  110 |  0 | 00110 | 1990-01-01 | 1990-01-01 | 0  | 0          | foo
! (10 rows)
  
  EXPLAIN (VERBOSE, COSTS OFF) SELECT t1 FROM ft1 t1 ORDER BY t1.c3, t1.c1 OFFSET 100 LIMIT 10;
                                                QUERY PLAN                                              
--- 215,223 ----
  (8 rows)
  
  SELECT * FROM ft1 t1 ORDER BY t1.c3, t1.c1, t1.tableoid OFFSET 100 LIMIT 10;
!  c1 | c2 | c3 | c4 | c5 | c6 | c7 | c8 
! ----+----+----+----+----+----+----+----
! (0 rows)
  
  EXPLAIN (VERBOSE, COSTS OFF) SELECT t1 FROM ft1 t1 ORDER BY t1.c3, t1.c1 OFFSET 100 LIMIT 10;
                                                QUERY PLAN                                              
***************
*** 252,270 ****
  (5 rows)
  
  SELECT t1 FROM ft1 t1 ORDER BY t1.c3, t1.c1 OFFSET 100 LIMIT 10;
!                            t1                           
! --------------------------------------------------------
!  (101,1,00101,1990-01-01,1990-01-01,1,"1         ",foo)
!  (102,2,00102,1990-01-01,1990-01-01,2,"2         ",foo)
!  (103,3,00103,1990-01-01,1990-01-01,3,"3         ",foo)
!  (104,4,00104,1990-01-01,1990-01-01,4,"4         ",foo)
!  (105,5,00105,1990-01-01,1990-01-01,5,"5         ",foo)
!  (106,6,00106,1990-01-01,1990-01-01,6,"6         ",foo)
!  (107,7,00107,1990-01-01,1990-01-01,7,"7         ",foo)
!  (108,8,00108,1990-01-01,1990-01-01,8,"8         ",foo)
!  (109,9,00109,1990-01-01,1990-01-01,9,"9         ",foo)
!  (110,0,00110,1990-01-01,1990-01-01,0,"0         ",foo)
! (10 rows)
  
  SELECT * FROM ft1 WHERE false;
   c1 | c2 | c3 | c4 | c5 | c6 | c7 | c8 
--- 230,238 ----
  (5 rows)
  
  SELECT t1 FROM ft1 t1 ORDER BY t1.c3, t1.c1 OFFSET 100 LIMIT 10;
!  t1 
! ----
! (0 rows)
  
  SELECT * FROM ft1 WHERE false;
   c1 | c2 | c3 | c4 | c5 | c6 | c7 | c8 
***************
*** 282,288 ****
  SELECT COUNT(*) FROM ft1 t1;
   count 
  -------
!    110
  (1 row)
  
  SELECT * FROM ft1 t1 WHERE t1.c3 IN (SELECT c2 FROM ft2 t2 WHERE c1 <= 10) ORDER BY c1;
--- 250,256 ----
  SELECT COUNT(*) FROM ft1 t1;
   count 
  -------
!      0
  (1 row)
  
  SELECT * FROM ft1 t1 WHERE t1.c3 IN (SELECT c2 FROM ft2 t2 WHERE c1 <= 10) ORDER BY c1;
***************
*** 296,320 ****
  (0 rows)
  
  WITH t1 AS (SELECT * FROM ft1 WHERE c1 <= 10) SELECT t2.c1, t2.c2, t2.c2 FROM t1, ft2 t2 WHERE t1.c1 = t2.c1 ORDER BY t1.c1;
!  c1 |   c2   |   c2   
! ----+--------+--------
!   1 | AAA001 | AAA001
!   2 | AAA002 | AAA002
!   3 | AAA003 | AAA003
!   4 | AAA004 | AAA004
!   5 | AAA005 | AAA005
!   6 | AAA006 | AAA006
!   7 | AAA007 | AAA007
!   8 | AAA008 | AAA008
!   9 | AAA009 | AAA009
!  10 | AAA010 | AAA010
! (10 rows)
  
  SELECT 'fixed', NULL FROM ft1 t1 WHERE c1 = 1;
   ?column? | ?column? 
  ----------+----------
!  fixed    | 
! (1 row)
  
  SET enable_hashjoin TO false;
  SET enable_nestloop TO false;
--- 264,277 ----
  (0 rows)
  
  WITH t1 AS (SELECT * FROM ft1 WHERE c1 <= 10) SELECT t2.c1, t2.c2, t2.c2 FROM t1, ft2 t2 WHERE t1.c1 = t2.c1 ORDER BY t1.c1;
!  c1 | c2 | c2 
! ----+----+----
! (0 rows)
  
  SELECT 'fixed', NULL FROM ft1 t1 WHERE c1 = 1;
   ?column? | ?column? 
  ----------+----------
! (0 rows)
  
  SET enable_hashjoin TO false;
  SET enable_nestloop TO false;
***************
*** 332,348 ****
  SELECT DISTINCT t1.c1, t2.c1 FROM ft2 t1 JOIN ft1 t2 ON (t1.c1 = t2.c1) order by t1.c1 LIMIT 10;
   c1 | c1 
  ----+----
!   1 |  1
!   2 |  2
!   3 |  3
!   4 |  4
!   5 |  5
!   6 |  6
!   7 |  7
!   8 |  8
!   9 |  9
!  10 | 10
! (10 rows)
  
  EXPLAIN (VERBOSE, COSTS OFF) SELECT t1.c1, t2.c1 FROM ft2 t1 LEFT JOIN ft1 t2 ON (t1.c1 = t2.c1) OFFSET 100 LIMIT 10;
                                                        QUERY PLAN                                                      
--- 289,295 ----
  SELECT DISTINCT t1.c1, t2.c1 FROM ft2 t1 JOIN ft1 t2 ON (t1.c1 = t2.c1) order by t1.c1 LIMIT 10;
   c1 | c1 
  ----+----
! (0 rows)
  
  EXPLAIN (VERBOSE, COSTS OFF) SELECT t1.c1, t2.c1 FROM ft2 t1 LEFT JOIN ft1 t2 ON (t1.c1 = t2.c1) OFFSET 100 LIMIT 10;
                                                        QUERY PLAN                                                      
***************
*** 358,383 ****
  EXPLAIN SELECT DISTINCT t1.c1, t2.c1 FROM ft2 t1 LEFT JOIN ft1 t2 ON (t1.c1 = t2.c1) order by t1.c1 LIMIT 10;
                           QUERY PLAN                          
  -------------------------------------------------------------
!  Limit  (cost=1.00..-1.00 rows=1 width=8)
     ->  Unique  (cost=1.00..-0.99 rows=1 width=8)
!          ->  Foreign Scan  (cost=1.00..-1.00 rows=1 width=1)
                 Relations: (ft2 t1) LEFT JOIN (ft1 t2)
  (4 rows)
  
  SELECT DISTINCT t1.c1, t2.c1 FROM ft2 t1 LEFT JOIN ft1 t2 ON (t1.c1 = t2.c1) order by t1.c1 LIMIT 10;
   c1 | c1 
  ----+----
!   1 |  1
!   2 |  2
!   3 |  3
!   4 |  4
!   5 |  5
!   6 |  6
!   7 |  7
!   8 |  8
!   9 |  9
!  10 | 10
! (10 rows)
  
  RESET enable_hashjoin;
  RESET enable_nestloop;
--- 305,320 ----
  EXPLAIN SELECT DISTINCT t1.c1, t2.c1 FROM ft2 t1 LEFT JOIN ft1 t2 ON (t1.c1 = t2.c1) order by t1.c1 LIMIT 10;
                           QUERY PLAN                          
  -------------------------------------------------------------
!  Limit  (cost=1.00..-0.99 rows=1 width=8)
     ->  Unique  (cost=1.00..-0.99 rows=1 width=8)
!          ->  Foreign Scan  (cost=1.00..-1.00 rows=2 width=2)
                 Relations: (ft2 t1) LEFT JOIN (ft1 t2)
  (4 rows)
  
  SELECT DISTINCT t1.c1, t2.c1 FROM ft2 t1 LEFT JOIN ft1 t2 ON (t1.c1 = t2.c1) order by t1.c1 LIMIT 10;
   c1 | c1 
  ----+----
! (0 rows)
  
  RESET enable_hashjoin;
  RESET enable_nestloop;
***************
*** 454,572 ****
  (3 rows)
  
  SELECT * FROM ft1 t1 WHERE c1 = ANY(ARRAY[c2, 1, c1 + 0]) ORDER BY c1; -- ScalarArrayOpExpr
!  c1  | c2 |  c3   |     c4     |     c5     | c6 |     c7     | c8  
! -----+----+-------+------------+------------+----+------------+-----
!    1 |  1 | 00001 | 1990-01-01 | 1990-01-01 | 1  | 1          | foo
!    2 |  2 | 00002 | 1990-01-01 | 1990-01-01 | 2  | 2          | foo
!    3 |  3 | 00003 | 1990-01-01 | 1990-01-01 | 3  | 3          | foo
!    4 |  4 | 00004 | 1990-01-01 | 1990-01-01 | 4  | 4          | foo
!    5 |  5 | 00005 | 1990-01-01 | 1990-01-01 | 5  | 5          | foo
!    6 |  6 | 00006 | 1990-01-01 | 1990-01-01 | 6  | 6          | foo
!    7 |  7 | 00007 | 1990-01-01 | 1990-01-01 | 7  | 7          | foo
!    8 |  8 | 00008 | 1990-01-01 | 1990-01-01 | 8  | 8          | foo
!    9 |  9 | 00009 | 1990-01-01 | 1990-01-01 | 9  | 9          | foo
!   10 |  0 | 00010 | 1990-01-01 | 1990-01-01 | 0  | 0          | foo
!   11 |  1 | 00011 | 1990-01-01 | 1990-01-01 | 1  | 1          | foo
!   12 |  2 | 00012 | 1990-01-01 | 1990-01-01 | 2  | 2          | foo
!   13 |  3 | 00013 | 1990-01-01 | 1990-01-01 | 3  | 3          | foo
!   14 |  4 | 00014 | 1990-01-01 | 1990-01-01 | 4  | 4          | foo
!   15 |  5 | 00015 | 1990-01-01 | 1990-01-01 | 5  | 5          | foo
!   16 |  6 | 00016 | 1990-01-01 | 1990-01-01 | 6  | 6          | foo
!   17 |  7 | 00017 | 1990-01-01 | 1990-01-01 | 7  | 7          | foo
!   18 |  8 | 00018 | 1990-01-01 | 1990-01-01 | 8  | 8          | foo
!   19 |  9 | 00019 | 1990-01-01 | 1990-01-01 | 9  | 9          | foo
!   20 |  0 | 00020 | 1990-01-01 | 1990-01-01 | 0  | 0          | foo
!   21 |  1 | 00021 | 1990-01-01 | 1990-01-01 | 1  | 1          | foo
!   22 |  2 | 00022 | 1990-01-01 | 1990-01-01 | 2  | 2          | foo
!   23 |  3 | 00023 | 1990-01-01 | 1990-01-01 | 3  | 3          | foo
!   24 |  4 | 00024 | 1990-01-01 | 1990-01-01 | 4  | 4          | foo
!   25 |  5 | 00025 | 1990-01-01 | 1990-01-01 | 5  | 5          | foo
!   26 |  6 | 00026 | 1990-01-01 | 1990-01-01 | 6  | 6          | foo
!   27 |  7 | 00027 | 1990-01-01 | 1990-01-01 | 7  | 7          | foo
!   28 |  8 | 00028 | 1990-01-01 | 1990-01-01 | 8  | 8          | foo
!   29 |  9 | 00029 | 1990-01-01 | 1990-01-01 | 9  | 9          | foo
!   30 |  0 | 00030 | 1990-01-01 | 1990-01-01 | 0  | 0          | foo
!   31 |  1 | 00031 | 1990-01-01 | 1990-01-01 | 1  | 1          | foo
!   32 |  2 | 00032 | 1990-01-01 | 1990-01-01 | 2  | 2          | foo
!   33 |  3 | 00033 | 1990-01-01 | 1990-01-01 | 3  | 3          | foo
!   34 |  4 | 00034 | 1990-01-01 | 1990-01-01 | 4  | 4          | foo
!   35 |  5 | 00035 | 1990-01-01 | 1990-01-01 | 5  | 5          | foo
!   36 |  6 | 00036 | 1990-01-01 | 1990-01-01 | 6  | 6          | foo
!   37 |  7 | 00037 | 1990-01-01 | 1990-01-01 | 7  | 7          | foo
!   38 |  8 | 00038 | 1990-01-01 | 1990-01-01 | 8  | 8          | foo
!   39 |  9 | 00039 | 1990-01-01 | 1990-01-01 | 9  | 9          | foo
!   40 |  0 | 00040 | 1990-01-01 | 1990-01-01 | 0  | 0          | foo
!   41 |  1 | 00041 | 1990-01-01 | 1990-01-01 | 1  | 1          | foo
!   42 |  2 | 00042 | 1990-01-01 | 1990-01-01 | 2  | 2          | foo
!   43 |  3 | 00043 | 1990-01-01 | 1990-01-01 | 3  | 3          | foo
!   44 |  4 | 00044 | 1990-01-01 | 1990-01-01 | 4  | 4          | foo
!   45 |  5 | 00045 | 1990-01-01 | 1990-01-01 | 5  | 5          | foo
!   46 |  6 | 00046 | 1990-01-01 | 1990-01-01 | 6  | 6          | foo
!   47 |  7 | 00047 | 1990-01-01 | 1990-01-01 | 7  | 7          | foo
!   48 |  8 | 00048 | 1990-01-01 | 1990-01-01 | 8  | 8          | foo
!   49 |  9 | 00049 | 1990-01-01 | 1990-01-01 | 9  | 9          | foo
!   50 |  0 | 00050 | 1990-01-01 | 1990-01-01 | 0  | 0          | foo
!   51 |  1 | 00051 | 1990-01-01 | 1990-01-01 | 1  | 1          | foo
!   52 |  2 | 00052 | 1990-01-01 | 1990-01-01 | 2  | 2          | foo
!   53 |  3 | 00053 | 1990-01-01 | 1990-01-01 | 3  | 3          | foo
!   54 |  4 | 00054 | 1990-01-01 | 1990-01-01 | 4  | 4          | foo
!   55 |  5 | 00055 | 1990-01-01 | 1990-01-01 | 5  | 5          | foo
!   56 |  6 | 00056 | 1990-01-01 | 1990-01-01 | 6  | 6          | foo
!   57 |  7 | 00057 | 1990-01-01 | 1990-01-01 | 7  | 7          | foo
!   58 |  8 | 00058 | 1990-01-01 | 1990-01-01 | 8  | 8          | foo
!   59 |  9 | 00059 | 1990-01-01 | 1990-01-01 | 9  | 9          | foo
!   60 |  0 | 00060 | 1990-01-01 | 1990-01-01 | 0  | 0          | foo
!   61 |  1 | 00061 | 1990-01-01 | 1990-01-01 | 1  | 1          | foo
!   62 |  2 | 00062 | 1990-01-01 | 1990-01-01 | 2  | 2          | foo
!   63 |  3 | 00063 | 1990-01-01 | 1990-01-01 | 3  | 3          | foo
!   64 |  4 | 00064 | 1990-01-01 | 1990-01-01 | 4  | 4          | foo
!   65 |  5 | 00065 | 1990-01-01 | 1990-01-01 | 5  | 5          | foo
!   66 |  6 | 00066 | 1990-01-01 | 1990-01-01 | 6  | 6          | foo
!   67 |  7 | 00067 | 1990-01-01 | 1990-01-01 | 7  | 7          | foo
!   68 |  8 | 00068 | 1990-01-01 | 1990-01-01 | 8  | 8          | foo
!   69 |  9 | 00069 | 1990-01-01 | 1990-01-01 | 9  | 9          | foo
!   70 |  0 | 00070 | 1990-01-01 | 1990-01-01 | 0  | 0          | foo
!   71 |  1 | 00071 | 1990-01-01 | 1990-01-01 | 1  | 1          | foo
!   72 |  2 | 00072 | 1990-01-01 | 1990-01-01 | 2  | 2          | foo
!   73 |  3 | 00073 | 1990-01-01 | 1990-01-01 | 3  | 3          | foo
!   74 |  4 | 00074 | 1990-01-01 | 1990-01-01 | 4  | 4          | foo
!   75 |  5 | 00075 | 1990-01-01 | 1990-01-01 | 5  | 5          | foo
!   76 |  6 | 00076 | 1990-01-01 | 1990-01-01 | 6  | 6          | foo
!   77 |  7 | 00077 | 1990-01-01 | 1990-01-01 | 7  | 7          | foo
!   78 |  8 | 00078 | 1990-01-01 | 1990-01-01 | 8  | 8          | foo
!   79 |  9 | 00079 | 1990-01-01 | 1990-01-01 | 9  | 9          | foo
!   80 |  0 | 00080 | 1990-01-01 | 1990-01-01 | 0  | 0          | foo
!   81 |  1 | 00081 | 1990-01-01 | 1990-01-01 | 1  | 1          | foo
!   82 |  2 | 00082 | 1990-01-01 | 1990-01-01 | 2  | 2          | foo
!   83 |  3 | 00083 | 1990-01-01 | 1990-01-01 | 3  | 3          | foo
!   84 |  4 | 00084 | 1990-01-01 | 1990-01-01 | 4  | 4          | foo
!   85 |  5 | 00085 | 1990-01-01 | 1990-01-01 | 5  | 5          | foo
!   86 |  6 | 00086 | 1990-01-01 | 1990-01-01 | 6  | 6          | foo
!   87 |  7 | 00087 | 1990-01-01 | 1990-01-01 | 7  | 7          | foo
!   88 |  8 | 00088 | 1990-01-01 | 1990-01-01 | 8  | 8          | foo
!   89 |  9 | 00089 | 1990-01-01 | 1990-01-01 | 9  | 9          | foo
!   90 |  0 | 00090 | 1990-01-01 | 1990-01-01 | 0  | 0          | foo
!   91 |  1 | 00091 | 1990-01-01 | 1990-01-01 | 1  | 1          | foo
!   92 |  2 | 00092 | 1990-01-01 | 1990-01-01 | 2  | 2          | foo
!   93 |  3 | 00093 | 1990-01-01 | 1990-01-01 | 3  | 3          | foo
!   94 |  4 | 00094 | 1990-01-01 | 1990-01-01 | 4  | 4          | foo
!   95 |  5 | 00095 | 1990-01-01 | 1990-01-01 | 5  | 5          | foo
!   96 |  6 | 00096 | 1990-01-01 | 1990-01-01 | 6  | 6          | foo
!   97 |  7 | 00097 | 1990-01-01 | 1990-01-01 | 7  | 7          | foo
!   98 |  8 | 00098 | 1990-01-01 | 1990-01-01 | 8  | 8          | foo
!   99 |  9 | 00099 | 1990-01-01 | 1990-01-01 | 9  | 9          | foo
!  100 |  0 | 00100 | 1990-01-01 | 1990-01-01 | 0  | 0          | foo
!  101 |  1 | 00101 | 1990-01-01 | 1990-01-01 | 1  | 1          | foo
!  102 |  2 | 00102 | 1990-01-01 | 1990-01-01 | 2  | 2          | foo
!  103 |  3 | 00103 | 1990-01-01 | 1990-01-01 | 3  | 3          | foo
!  104 |  4 | 00104 | 1990-01-01 | 1990-01-01 | 4  | 4          | foo
!  105 |  5 | 00105 | 1990-01-01 | 1990-01-01 | 5  | 5          | foo
!  106 |  6 | 00106 | 1990-01-01 | 1990-01-01 | 6  | 6          | foo
!  107 |  7 | 00107 | 1990-01-01 | 1990-01-01 | 7  | 7          | foo
!  108 |  8 | 00108 | 1990-01-01 | 1990-01-01 | 8  | 8          | foo
!  109 |  9 | 00109 | 1990-01-01 | 1990-01-01 | 9  | 9          | foo
!  110 |  0 | 00110 | 1990-01-01 | 1990-01-01 | 0  | 0          | foo
! (110 rows)
  
  EXPLAIN (VERBOSE, COSTS OFF) SELECT * FROM ft1 t1 WHERE c1 = (ARRAY[c1,c2,3])[1]; -- ArrayRef
                                                    QUERY PLAN                                                   
--- 391,399 ----
  (3 rows)
  
  SELECT * FROM ft1 t1 WHERE c1 = ANY(ARRAY[c2, 1, c1 + 0]) ORDER BY c1; -- ScalarArrayOpExpr
!  c1 | c2 | c3 | c4 | c5 | c6 | c7 | c8 
! ----+----+----+----+----+----+----+----
! (0 rows)
  
  EXPLAIN (VERBOSE, COSTS OFF) SELECT * FROM ft1 t1 WHERE c1 = (ARRAY[c1,c2,3])[1]; -- ArrayRef
                                                    QUERY PLAN                                                   
***************
*** 577,695 ****
  (3 rows)
  
  SELECT * FROM ft1 t1 WHERE c1 = (ARRAY[c1,c2,3])[1] ORDER BY c1; -- ArrayRef
!  c1  | c2 |  c3   |     c4     |     c5     | c6 |     c7     | c8  
! -----+----+-------+------------+------------+----+------------+-----
!    1 |  1 | 00001 | 1990-01-01 | 1990-01-01 | 1  | 1          | foo
!    2 |  2 | 00002 | 1990-01-01 | 1990-01-01 | 2  | 2          | foo
!    3 |  3 | 00003 | 1990-01-01 | 1990-01-01 | 3  | 3          | foo
!    4 |  4 | 00004 | 1990-01-01 | 1990-01-01 | 4  | 4          | foo
!    5 |  5 | 00005 | 1990-01-01 | 1990-01-01 | 5  | 5          | foo
!    6 |  6 | 00006 | 1990-01-01 | 1990-01-01 | 6  | 6          | foo
!    7 |  7 | 00007 | 1990-01-01 | 1990-01-01 | 7  | 7          | foo
!    8 |  8 | 00008 | 1990-01-01 | 1990-01-01 | 8  | 8          | foo
!    9 |  9 | 00009 | 1990-01-01 | 1990-01-01 | 9  | 9          | foo
!   10 |  0 | 00010 | 1990-01-01 | 1990-01-01 | 0  | 0          | foo
!   11 |  1 | 00011 | 1990-01-01 | 1990-01-01 | 1  | 1          | foo
!   12 |  2 | 00012 | 1990-01-01 | 1990-01-01 | 2  | 2          | foo
!   13 |  3 | 00013 | 1990-01-01 | 1990-01-01 | 3  | 3          | foo
!   14 |  4 | 00014 | 1990-01-01 | 1990-01-01 | 4  | 4          | foo
!   15 |  5 | 00015 | 1990-01-01 | 1990-01-01 | 5  | 5          | foo
!   16 |  6 | 00016 | 1990-01-01 | 1990-01-01 | 6  | 6          | foo
!   17 |  7 | 00017 | 1990-01-01 | 1990-01-01 | 7  | 7          | foo
!   18 |  8 | 00018 | 1990-01-01 | 1990-01-01 | 8  | 8          | foo
!   19 |  9 | 00019 | 1990-01-01 | 1990-01-01 | 9  | 9          | foo
!   20 |  0 | 00020 | 1990-01-01 | 1990-01-01 | 0  | 0          | foo
!   21 |  1 | 00021 | 1990-01-01 | 1990-01-01 | 1  | 1          | foo
!   22 |  2 | 00022 | 1990-01-01 | 1990-01-01 | 2  | 2          | foo
!   23 |  3 | 00023 | 1990-01-01 | 1990-01-01 | 3  | 3          | foo
!   24 |  4 | 00024 | 1990-01-01 | 1990-01-01 | 4  | 4          | foo
!   25 |  5 | 00025 | 1990-01-01 | 1990-01-01 | 5  | 5          | foo
!   26 |  6 | 00026 | 1990-01-01 | 1990-01-01 | 6  | 6          | foo
!   27 |  7 | 00027 | 1990-01-01 | 1990-01-01 | 7  | 7          | foo
!   28 |  8 | 00028 | 1990-01-01 | 1990-01-01 | 8  | 8          | foo
!   29 |  9 | 00029 | 1990-01-01 | 1990-01-01 | 9  | 9          | foo
!   30 |  0 | 00030 | 1990-01-01 | 1990-01-01 | 0  | 0          | foo
!   31 |  1 | 00031 | 1990-01-01 | 1990-01-01 | 1  | 1          | foo
!   32 |  2 | 00032 | 1990-01-01 | 1990-01-01 | 2  | 2          | foo
!   33 |  3 | 00033 | 1990-01-01 | 1990-01-01 | 3  | 3          | foo
!   34 |  4 | 00034 | 1990-01-01 | 1990-01-01 | 4  | 4          | foo
!   35 |  5 | 00035 | 1990-01-01 | 1990-01-01 | 5  | 5          | foo
!   36 |  6 | 00036 | 1990-01-01 | 1990-01-01 | 6  | 6          | foo
!   37 |  7 | 00037 | 1990-01-01 | 1990-01-01 | 7  | 7          | foo
!   38 |  8 | 00038 | 1990-01-01 | 1990-01-01 | 8  | 8          | foo
!   39 |  9 | 00039 | 1990-01-01 | 1990-01-01 | 9  | 9          | foo
!   40 |  0 | 00040 | 1990-01-01 | 1990-01-01 | 0  | 0          | foo
!   41 |  1 | 00041 | 1990-01-01 | 1990-01-01 | 1  | 1          | foo
!   42 |  2 | 00042 | 1990-01-01 | 1990-01-01 | 2  | 2          | foo
!   43 |  3 | 00043 | 1990-01-01 | 1990-01-01 | 3  | 3          | foo
!   44 |  4 | 00044 | 1990-01-01 | 1990-01-01 | 4  | 4          | foo
!   45 |  5 | 00045 | 1990-01-01 | 1990-01-01 | 5  | 5          | foo
!   46 |  6 | 00046 | 1990-01-01 | 1990-01-01 | 6  | 6          | foo
!   47 |  7 | 00047 | 1990-01-01 | 1990-01-01 | 7  | 7          | foo
!   48 |  8 | 00048 | 1990-01-01 | 1990-01-01 | 8  | 8          | foo
!   49 |  9 | 00049 | 1990-01-01 | 1990-01-01 | 9  | 9          | foo
!   50 |  0 | 00050 | 1990-01-01 | 1990-01-01 | 0  | 0          | foo
!   51 |  1 | 00051 | 1990-01-01 | 1990-01-01 | 1  | 1          | foo
!   52 |  2 | 00052 | 1990-01-01 | 1990-01-01 | 2  | 2          | foo
!   53 |  3 | 00053 | 1990-01-01 | 1990-01-01 | 3  | 3          | foo
!   54 |  4 | 00054 | 1990-01-01 | 1990-01-01 | 4  | 4          | foo
!   55 |  5 | 00055 | 1990-01-01 | 1990-01-01 | 5  | 5          | foo
!   56 |  6 | 00056 | 1990-01-01 | 1990-01-01 | 6  | 6          | foo
!   57 |  7 | 00057 | 1990-01-01 | 1990-01-01 | 7  | 7          | foo
!   58 |  8 | 00058 | 1990-01-01 | 1990-01-01 | 8  | 8          | foo
!   59 |  9 | 00059 | 1990-01-01 | 1990-01-01 | 9  | 9          | foo
!   60 |  0 | 00060 | 1990-01-01 | 1990-01-01 | 0  | 0          | foo
!   61 |  1 | 00061 | 1990-01-01 | 1990-01-01 | 1  | 1          | foo
!   62 |  2 | 00062 | 1990-01-01 | 1990-01-01 | 2  | 2          | foo
!   63 |  3 | 00063 | 1990-01-01 | 1990-01-01 | 3  | 3          | foo
!   64 |  4 | 00064 | 1990-01-01 | 1990-01-01 | 4  | 4          | foo
!   65 |  5 | 00065 | 1990-01-01 | 1990-01-01 | 5  | 5          | foo
!   66 |  6 | 00066 | 1990-01-01 | 1990-01-01 | 6  | 6          | foo
!   67 |  7 | 00067 | 1990-01-01 | 1990-01-01 | 7  | 7          | foo
!   68 |  8 | 00068 | 1990-01-01 | 1990-01-01 | 8  | 8          | foo
!   69 |  9 | 00069 | 1990-01-01 | 1990-01-01 | 9  | 9          | foo
!   70 |  0 | 00070 | 1990-01-01 | 1990-01-01 | 0  | 0          | foo
!   71 |  1 | 00071 | 1990-01-01 | 1990-01-01 | 1  | 1          | foo
!   72 |  2 | 00072 | 1990-01-01 | 1990-01-01 | 2  | 2          | foo
!   73 |  3 | 00073 | 1990-01-01 | 1990-01-01 | 3  | 3          | foo
!   74 |  4 | 00074 | 1990-01-01 | 1990-01-01 | 4  | 4          | foo
!   75 |  5 | 00075 | 1990-01-01 | 1990-01-01 | 5  | 5          | foo
!   76 |  6 | 00076 | 1990-01-01 | 1990-01-01 | 6  | 6          | foo
!   77 |  7 | 00077 | 1990-01-01 | 1990-01-01 | 7  | 7          | foo
!   78 |  8 | 00078 | 1990-01-01 | 1990-01-01 | 8  | 8          | foo
!   79 |  9 | 00079 | 1990-01-01 | 1990-01-01 | 9  | 9          | foo
!   80 |  0 | 00080 | 1990-01-01 | 1990-01-01 | 0  | 0          | foo
!   81 |  1 | 00081 | 1990-01-01 | 1990-01-01 | 1  | 1          | foo
!   82 |  2 | 00082 | 1990-01-01 | 1990-01-01 | 2  | 2          | foo
!   83 |  3 | 00083 | 1990-01-01 | 1990-01-01 | 3  | 3          | foo
!   84 |  4 | 00084 | 1990-01-01 | 1990-01-01 | 4  | 4          | foo
!   85 |  5 | 00085 | 1990-01-01 | 1990-01-01 | 5  | 5          | foo
!   86 |  6 | 00086 | 1990-01-01 | 1990-01-01 | 6  | 6          | foo
!   87 |  7 | 00087 | 1990-01-01 | 1990-01-01 | 7  | 7          | foo
!   88 |  8 | 00088 | 1990-01-01 | 1990-01-01 | 8  | 8          | foo
!   89 |  9 | 00089 | 1990-01-01 | 1990-01-01 | 9  | 9          | foo
!   90 |  0 | 00090 | 1990-01-01 | 1990-01-01 | 0  | 0          | foo
!   91 |  1 | 00091 | 1990-01-01 | 1990-01-01 | 1  | 1          | foo
!   92 |  2 | 00092 | 1990-01-01 | 1990-01-01 | 2  | 2          | foo
!   93 |  3 | 00093 | 1990-01-01 | 1990-01-01 | 3  | 3          | foo
!   94 |  4 | 00094 | 1990-01-01 | 1990-01-01 | 4  | 4          | foo
!   95 |  5 | 00095 | 1990-01-01 | 1990-01-01 | 5  | 5          | foo
!   96 |  6 | 00096 | 1990-01-01 | 1990-01-01 | 6  | 6          | foo
!   97 |  7 | 00097 | 1990-01-01 | 1990-01-01 | 7  | 7          | foo
!   98 |  8 | 00098 | 1990-01-01 | 1990-01-01 | 8  | 8          | foo
!   99 |  9 | 00099 | 1990-01-01 | 1990-01-01 | 9  | 9          | foo
!  100 |  0 | 00100 | 1990-01-01 | 1990-01-01 | 0  | 0          | foo
!  101 |  1 | 00101 | 1990-01-01 | 1990-01-01 | 1  | 1          | foo
!  102 |  2 | 00102 | 1990-01-01 | 1990-01-01 | 2  | 2          | foo
!  103 |  3 | 00103 | 1990-01-01 | 1990-01-01 | 3  | 3          | foo
!  104 |  4 | 00104 | 1990-01-01 | 1990-01-01 | 4  | 4          | foo
!  105 |  5 | 00105 | 1990-01-01 | 1990-01-01 | 5  | 5          | foo
!  106 |  6 | 00106 | 1990-01-01 | 1990-01-01 | 6  | 6          | foo
!  107 |  7 | 00107 | 1990-01-01 | 1990-01-01 | 7  | 7          | foo
!  108 |  8 | 00108 | 1990-01-01 | 1990-01-01 | 8  | 8          | foo
!  109 |  9 | 00109 | 1990-01-01 | 1990-01-01 | 9  | 9          | foo
!  110 |  0 | 00110 | 1990-01-01 | 1990-01-01 | 0  | 0          | foo
! (110 rows)
  
  EXPLAIN (VERBOSE, COSTS OFF) SELECT * FROM ft1 t1 WHERE c6 = E'foo''s\\bar';  -- check special chars
                                                QUERY PLAN                                              
--- 404,412 ----
  (3 rows)
  
  SELECT * FROM ft1 t1 WHERE c1 = (ARRAY[c1,c2,3])[1] ORDER BY c1; -- ArrayRef
!  c1 | c2 | c3 | c4 | c5 | c6 | c7 | c8 
! ----+----+----+----+----+----+----+----
! (0 rows)
  
  EXPLAIN (VERBOSE, COSTS OFF) SELECT * FROM ft1 t1 WHERE c6 = E'foo''s\\bar';  -- check special chars
                                                QUERY PLAN                                              
***************
*** 724,733 ****
  	sum(length(c2)) FROM ft2 GROUP BY a ORDER BY a;
   a | sum 
  ---+-----
!  1 |  54
!  2 | 240
!  3 | 306
! (3 rows)
  
  EXPLAIN (VERBOSE, COSTS OFF) SELECT SUM(c1) FILTER (WHERE c1 < 20) FROM ft2;
                           QUERY PLAN                          
--- 441,447 ----
  	sum(length(c2)) FROM ft2 GROUP BY a ORDER BY a;
   a | sum 
  ---+-----
! (0 rows)
  
  EXPLAIN (VERBOSE, COSTS OFF) SELECT SUM(c1) FILTER (WHERE c1 < 20) FROM ft2;
                           QUERY PLAN                          
***************
*** 741,747 ****
  SELECT SUM(c1) FILTER (WHERE c1 < 20) FROM ft2;
   sum 
  -----
!  190
  (1 row)
  
  EXPLAIN (VERBOSE, COSTS OFF) SELECT COUNT(DISTINCT c1) FROM ft2;
--- 455,461 ----
  SELECT SUM(c1) FILTER (WHERE c1 < 20) FROM ft2;
   sum 
  -----
!    0
  (1 row)
  
  EXPLAIN (VERBOSE, COSTS OFF) SELECT COUNT(DISTINCT c1) FROM ft2;
***************
*** 756,762 ****
  SELECT COUNT(DISTINCT c1) FROM ft2;
   count 
  -------
!    100
  (1 row)
  
  /* DISTINCT with IF */
--- 470,476 ----
  SELECT COUNT(DISTINCT c1) FROM ft2;
   count 
  -------
!      0
  (1 row)
  
  /* DISTINCT with IF */

======================================================================

